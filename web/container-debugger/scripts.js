"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}angular.module("application",["ngCookies","stg.debugger","stg.debugger.templates","ui.bootstrap","ui.router","ngAnimate"]).run(["$rootScope","stg.debugger.debugger","$state","$window",function(e,t,r,a){var i=400,n=800,s=600,o=0;e["debugger"]=t,e.$state=r,e.isMobile=function(){return a.parent.screen.availWidth<i&&a.orientation===o},e.isHelperVisible=function(){return!(a.parent.innerWidth<=n&&a.parent.innerHeight<=s)},a.addEventListener("orientationchange",function(){e.$digest()},!1)}]).config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("overview",{url:"/overview",templateUrl:"pages/overview/overview.html"}).state("overview.tags",{url:"/tags",templateUrl:"pages/overview/tags/tags.html",controller:"stg.debugger.OverviewTagsController as view"}).state("overview.tag-details",{url:"/tags/{id}",controller:"stg.debugger.OverviewTagDetailsController as view",templateUrl:"pages/overview/tag-details/tag-details.html"}).state("events-log",{url:"/events-log",templateUrl:"pages/events-log/events-log.html"}).state("events-log.list",{url:"/list",controller:"stg.debugger.EventsLogController as view",templateUrl:"pages/events-log/list/list.html"}).state("events-log.details",{url:"/{eventId}",controller:"stg.debugger.EventsLogDetailsController as view",templateUrl:"pages/events-log/details/details.html"}).state("events-log.details.variables",{url:"/variables",templateUrl:"pages/events-log/details/variables/variables.html"}).state("events-log.details.data-layer",{url:"/data-layer",templateUrl:"pages/events-log/details/data-layer/data-layer.html"}).state("events-log.details.related-tags",{url:"/related-tags",templateUrl:"pages/events-log/details/related-tags/related-tags.html"}).state("events-log.details.related-tags.list",{url:"/list",templateUrl:"pages/events-log/details/related-tags/list/list.html"}).state("events-log.details.related-tags.details",{url:"/{id}",templateUrl:"pages/events-log/details/related-tags/details/details.html",controller:"stg.debugger.EventsLogTagDetailsController as details"}),t.otherwise("/overview/tags")}]);var MODULE_NAME="stg.debugger",TEMPLATE_MODULE_NAME="stg.debugger.templates";angular.module(MODULE_NAME,["ngCookies","ui.router"]),angular.module(TEMPLATE_MODULE_NAME,[]).constant("ENVIRONMENT",void 0===window.stgEnv?"prod":window.stgEnv);var countableDirective=function(e){return{restrict:"A",replace:!0,scope:{model:"=",countClass:"@",delay:"@"},link:function(t,r){var a=t.model;t.$watch("model",function(i){i!==a&&(r.addClass(t.countClass),e(function(){r.removeClass(t.countClass)},t.delay||1e3))})}}};countableDirective.$inject=["$timeout"],angular.module("stg.debugger").directive("countable",countableDirective);var helpSystemDirective=function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@"},templateUrl:"ccHelp.html"}};angular.module("stg.debugger").directive("ccHelp",helpSystemDirective);var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),StateSummary=function(){function e(){_classCallCheck(this,e),this.tagSummaryCollection={},this.dataLayerElement=void 0,this.variableCollection=void 0}return _createClass(e,[{key:"addTagSummary",value:function(e,t){return this.tagSummaryCollection[e]=t,e}},{key:"getTagSummary",value:function(e){return void 0===this.tagSummaryCollection[e]?!1:this.tagSummaryCollection[e]}},{key:"getTagSummaryCollection",value:function(){return this.tagSummaryCollection}}]),e}();angular.module("stg.debugger").value("stg.debugger.StateSummary",StateSummary);var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),TagSummary=function(){function e(){_classCallCheck(this,e),this.id=void 0,this.$name="",this.$code="",this.$fired=0,this.$respectVisitorsPrivacy=!1,this.$disableInDebugMode=!1,this.$triggers=[],this.$dataLayerStates=[]}return _createClass(e,[{key:"addDataLayerState",value:function(e){return this.$dataLayerStates.push(e),this}},{key:"hasDataLayerState",value:function(e){for(var t in this.$dataLayerStates)if(this.$dataLayerStates[t]===e)return!0;return!1}},{key:"increaseFiredCount",value:function(){return this.$fired++,this}},{key:"markResolvedTriggers",value:function(e){for(var t in this.$triggers)this.$triggers[t].resolved=e.indexOf(this.$triggers[t].id)>-1}},{key:"markResolvedConditions",value:function(e,t){for(var r in this.$triggers[e].conditions)this.$triggers[e].conditions[r].resolved=!1;for(var r in t)this.$triggers[e].conditions[r].resolved=!0}},{key:"isRespectVisitorsPrivacy",value:function(e){return this.respectVisitorsPrivacy&&e}},{key:"isFiredMoreThenOnce",value:function(){return this.firedCount>1&&!this.disableInDebugMode}},{key:"isFiredOnce",value:function(){return 1===this.firedCount&&!this.disableInDebugMode}},{key:"isFired",value:function(){return this.firedCount>0&&!this.disableInDebugMode}},{key:"isDisabled",value:function(){return this.disableInDebugMode}},{key:"name",get:function(){return this.$name},set:function(e){return this.$name=e,this}},{key:"code",get:function(){return this.$code},set:function(e){return this.$code=e,this}},{key:"disableInDebugMode",get:function(){return this.$disableInDebugMode},set:function(e){return this.$disableInDebugMode=e,this}},{key:"respectVisitorsPrivacy",get:function(){return this.$respectVisitorsPrivacy},set:function(e){return this.$respectVisitorsPrivacy=e,this}},{key:"firedCount",get:function(){return this.$fired}},{key:"triggers",get:function(){return this.$triggers}},{key:"firedTriggers",get:function(){var e=[];for(var t in this.$triggers)this.$triggers[t].resolved&&e.push(this.$triggers[t]);return e},set:function(e){return this.$triggers=e,this}},{key:"notFiredTriggers",get:function(){var e=[];for(var t in this.$triggers)void 0!==this.$triggers[t].resolved&&this.$triggers[t].resolved!==!1||e.push(this.$triggers[t]);return e}}]),e}();angular.module("stg.debugger").value("stg.debugger.TagSummary",TagSummary);var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),div,Wrapper=function(){function e(t){_classCallCheck(this,e),div=window.parent.document.getElementById(t),this.navbar=window.document.getElementById("navbar"),this.isMobile()&&(this.navbar.style.background="#2e9354")}return _createClass(e,[{key:"isMobile",value:function(){return window.parent.innerWidth<400}},{key:"maximize",value:function(){null!==div&&(this.isMobile()?div.style.width="100%":div.style.width="400px",div.style.height="100%",div.style.position="fixed",div.style.zIndex="2147483647",div.style.right=0,div.style.top=0,setTimeout(function(){angular.element(window.document.body).removeClass("minimize")},500))}},{key:"minimize",value:function(){null!==div&&(this.isMobile()?(div.style.width="100%",div.style.height="60px"):div.style.width="60px",angular.element(window.document.body).addClass("minimize"))}}],[{key:"wrapperFactory",value:function(t){return new e(t)}}]),e}();angular.module("stg.debugger").value("seventagContainerDebuggerId","seventag_container_debugger").factory("stg.debugger.wrapper",["seventagContainerDebuggerId",Wrapper.wrapperFactory]);var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),STACK_LIMIT=300,DataLayerLimitedStack=function(){function e(t){_classCallCheck(this,e),this.setLimit(t),this.$stack=[]}return _createClass(e,[{key:"setLimit",value:function(e){this.$limit=this.isLimitDefined(e)?e:STACK_LIMIT}},{key:"isLimitDefined",value:function(e){return void 0!==e}},{key:"isLimitExceeded",value:function(){return this.$stack.length>=this.$limit}},{key:"push",value:function(e){this.isLimitExceeded()&&this.$stack.shift(),this.$stack.push(e)}},{key:"get",value:function(e){return void 0!==this.$stack[e]?this.$stack[e]:!1}},{key:"stack",get:function(){return this.$stack}}]),e}();DataLayerLimitedStack.$inject=[],angular.module("stg.debugger").service("stg.debugger.dataLayerLimitedStack",DataLayerLimitedStack);var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),DataLayerReport=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"getFiredTags",value:function(e){var t=[];for(var r in e.tagSummaryCollection)e.tagSummaryCollection[r].firedTriggers.length>0&&!e.tagSummaryCollection[r].disableInDebugMode&&t.push(e.tagSummaryCollection[r]);return t}},{key:"getDisabledFiredTags",value:function(e){var t=[];for(var r in e.tagSummaryCollection)e.tagSummaryCollection[r].firedTriggers.length>0&&e.tagSummaryCollection[r].disableInDebugMode&&t.push(e.tagSummaryCollection[r]);return t}},{key:"getNotFiredTags",value:function(e){var t=[];for(var r in e.tagSummaryCollection)0===e.tagSummaryCollection[r].firedTriggers.length&&t.push(e.tagSummaryCollection[r]);return t}}]),e}();DataLayerReport.$inject=[],angular.module("stg.debugger").service("stg.debugger.DataLayerReport",DataLayerReport);var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),Debugger=function(){function e(t,r,a){_classCallCheck(this,e),void 0!==t.debugOptions&&void 0!==t.debugOptions.containerName&&(this.$containerName=t.debugOptions.containerName),this.$debugger=t["debugger"],this.$tagTree=angular.copy(t.tagTree),this.$timeout=r,this.minimizedMemento=a}return _createClass(e,[{key:"close",value:function(){void 0!==this.$debugger.close&&this.$debugger.close()}},{key:"getContainerName",value:function(){return this.$containerName}},{key:"getTagTree",value:function(){return this.$tagTree}},{key:"getDataLayerStates",value:function(){return void 0!==this.$debugger.stack?this.$debugger.stack:void 0}},{key:"addListenerContainerStates",value:function(e){var t=this;this.$debugger.addListener(function(){t.$timeout(e)})}}]),e}();Debugger.$inject=["$container","$timeout","stg.debugger.minimizedMemento"],angular.module("stg.debugger").service("stg.debugger.debugger",Debugger);var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),MinimizedMemento=function(){function e(t,r){_classCallCheck(this,e),this.$wrapper=t,this.$cookies=r,this.setMinimized(!1)}return _createClass(e,[{key:"setMinimized",value:function(e){window.parent.stgDebuggerMinimized=e}},{key:"isMinimized",value:function(){return window.parent.stgDebuggerMinimized}},{key:"isMaximized",value:function(){return!this.isMinimized()}},{key:"maximize",value:function(){this.setMinimized(!1),this.$wrapper.maximize()}},{key:"minimize",value:function(){this.setMinimized(!0),this.$wrapper.minimize()}}]),e}();MinimizedMemento.$inject=["stg.debugger.wrapper","$cookies"],angular.module("stg.debugger").service("stg.debugger.minimizedMemento",MinimizedMemento);var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),StateSummary=void 0,TagSummary=void 0,Report=function(){function e(t,r,a,i,n){_classCallCheck(this,e);var s=this;StateSummary=r,TagSummary=a,this.$filter=n,this.$debugger=t,this.$dataLayerLimitedStack=i,this.stateSummary=new StateSummary;var o=t.getTagTree(),l=void 0;for(var u in o)l=new TagSummary,l.id=o[u].id,l.name=o[u].name,l.code=o[u].code,l.firedTriggers=o[u].triggers,l.disableInDebugMode=o[u].disableInDebugMode,l.respectVisitorsPrivacy=o[u].respectVisitorsPrivacy,this.stateSummary.addTagSummary(o[u].id,l);this.updateSummary(),t.addListenerContainerStates(function(){s.updateSummary()})}return _createClass(e,[{key:"updateSummary",value:function(){for(var e=this.$debugger.getDataLayerStates(),t=void 0;e.length;){var r=e.shift(),a=r.tags,i=new StateSummary;i.dataLayerElement=r.dataLayerElement,i.variableCollection=r.variableCollection;for(var n in a)if(t=new TagSummary,t.id=a[n].id,t.name=a[n].name,t.code=a[n].code,t.firedTriggers=a[n].triggers,t.resolved=a[n].resolved,t.disableInDebugMode=a[n].disableInDebugMode,t.respectVisitorsPrivacy=a[n].respectVisitorsPrivacy,i.addTagSummary(a[n].id,t),a[n].resolved&&void 0!==a[n].id){var s=[];for(var o in a[n].triggers)a[n].triggers[o].resolved&&s.push(a[n].triggers[o].id);this.stateSummary.getTagSummary(a[n].id).increaseFiredCount().markResolvedTriggers(s)}this.$dataLayerLimitedStack.push(i)}}},{key:"getFiredTags",value:function(){return this.$filter("firedTags")(this.stateSummary.getTagSummaryCollection())}},{key:"getDisabledFiredTags",value:function(){return this.$filter("firedDisabledTags")(this.stateSummary.getTagSummaryCollection())}},{key:"getNotFiredTags",value:function(){return this.$filter("notFiredTags")(this.stateSummary.getTagSummaryCollection())}},{key:"dataLayerLimitedStack",get:function(){return this.$dataLayerLimitedStack}}]),e}();Report.$inject=["stg.debugger.debugger","stg.debugger.StateSummary","stg.debugger.TagSummary","stg.debugger.dataLayerLimitedStack","$filter"],angular.module("stg.debugger").service("stg.debugger.report",Report),function(e){angular.module("stg.debugger").value("$container",e.sevenTag)}(parent),function(e){angular.module("stg.debugger").value("$container",e.sevenTag)}(parent);var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),EventsLogDetailsController=function(){function e(t,r){_classCallCheck(this,e),this.dataLayerLimitedStack=t,this.stateParams=r}return _createClass(e,[{key:"summary",get:function(){return this.dataLayerLimitedStack.get(this.stateParams.eventId)}},{key:"eventId",get:function(){return this.stateParams.eventId}},{key:"tagSummary",get:function(){return angular.equals({},this.summary.tagSummaryCollection)?void 0:this.summary.tagSummaryCollection}}]),e}();EventsLogDetailsController.$inject=["stg.debugger.dataLayerLimitedStack","$stateParams"],angular.module("stg.debugger").controller("stg.debugger.EventsLogDetailsController",EventsLogDetailsController);var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),OverviewTagDetailsController=function(){function e(t,r,a){_classCallCheck(this,e),this.report=t,this.stateParams=r,this.doNotTrackEnabled=a.$doNotTrack.isEnabled()}return _createClass(e,[{key:"tagSummary",get:function(){return this.report.stateSummary.getTagSummary(this.stateParams.id)}}]),e}();OverviewTagDetailsController.$inject=["stg.debugger.report","$stateParams","$container"],angular.module("stg.debugger").controller("stg.debugger.OverviewTagDetailsController",OverviewTagDetailsController);var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),EventsLogController=function(){function e(t){_classCallCheck(this,e),this.report=t}return _createClass(e,[{key:"eventLog",get:function(){return this.report.dataLayerLimitedStack.stack}}]),e}();EventsLogController.$inject=["stg.debugger.report"],angular.module("stg.debugger").controller("stg.debugger.EventsLogController",EventsLogController);var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),OverviewTagsController=function(){function e(t,r,a){_classCallCheck(this,e),this.report=t,this.state=r,this.doNotTrackEnabled=a.$doNotTrack.isEnabled()}return _createClass(e,[{key:"tags",get:function(){return angular.equals({},this.report.stateSummary.tagSummaryCollection)?void 0:this.report.stateSummary.tagSummaryCollection}}]),e}();OverviewTagsController.$inject=["stg.debugger.report","$state","$container"],angular.module("stg.debugger").controller("stg.debugger.OverviewTagsController",OverviewTagsController);var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),EventsLogTagDetailsController=function(){function e(t,r){_classCallCheck(this,e),this.scope=r,this.stateParams=t}return _createClass(e,[{key:"tagSummary",get:function(){return this.scope.view.summary.getTagSummary(this.stateParams.id)}}]),e}();EventsLogTagDetailsController.$inject=["$stateParams","$scope"],angular.module("stg.debugger").controller("stg.debugger.EventsLogTagDetailsController",EventsLogTagDetailsController);
//# sourceMappingURL=scripts.js.map
